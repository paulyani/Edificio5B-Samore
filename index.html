</html>
<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Enviar WhatsApp Edificio</title>
<style>
  body {
    font-family: Arial, sans-serif;
    max-width: 480px;
    margin: 30px auto;
    background: #f9f9f9;
    padding: 15px;
    border-radius: 8px;
    box-shadow: 0 0 10px #ccc;
  }
  label {
    display: block;
    margin: 12px 0 6px;
  }
  select, input[type=text] {
    width: 100%;
    padding: 8px 10px;
    font-size: 1rem;
    border: 1px solid #ccc;
    border-radius: 4px;
  }
  #persona-container {
    margin-top: 10px;
  }
  button {
    margin-top: 15px;
    width: 100%;
    padding: 10px;
    font-size: 1.1rem;
    border: none;
    border-radius: 4px;
    background-color: #2b7a78;
    color: white;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }
  button:hover {
    background-color: #3aafa9;
  }
  #mensaje {
    margin-top: 15px;
    font-weight: bold;
    height: 24px;
    text-align: center;
  }
</style>
</head>
<body>
<h2>Enviar mensaje a contacto</h2>

<label for="depto">Departamento:</label>
<select id="depto">
  <option value="">-- Seleccioná un departamento --</option>
  <option value="PB">PB</option>
  <option value="0D">0D</option>
  <option value="0E">0E</option>
  <option value="0F">0F</option>
  <option value="1D">1D</option>
  <option value="1E">1E</option>
  <option value="1F">1F</option>
  <option value="2D">2D</option>
  <option value="2E">2E</option>
  <option value="2F">2F</option>
  <option value="3D">3D</option>
  <option value="3E">3E</option>
  <option value="3F">3F</option>
  <option value="4D">4D</option>
  <option value="4E">4E</option>
  <option value="4F">4F</option>
  <option value="5D">5D</option>
  <option value="5E">5E</option>
  <option value="5F">5F</option>
  <option value="6D">6D</option>
  <option value="6E">6E</option>
  <option value="6F">6F</option>
  <option value="7D">7D</option>
  <option value="7E">7E</option>
  <option value="7F">7F</option>
  <option value="8D">8D</option>
  <option value="8E">8E</option>
  <option value="8F">8F</option>
  <option value="9D">9D</option>
  <option value="9E">9E</option>
  <option value="9F">9F</option>
</select>

<div id="persona-container" style="display:none;">
  <label for="persona">Contacto:</label>
  <select id="persona"></select>
</div>

<label for="tipo">Tipo (Ej: Repartidor, Visitante):</label>
<input type="text" id="tipo" placeholder="Tu tipo aquí" />

<button id="btnEnviar">Enviar mensaje WhatsApp</button>
<button id="btnPorteria">Avisar a Portería</button>

<div id="mensaje"></div>

<script>
const contactos = {
  "PB": [
    { nombre: "Portería General", numero: "5491100000001" }
  ],
  "0D": [
    { nombre: "Propietario 0D 1", numero: "5491100000004" },
    { nombre: "Propietario 0D 2", numero: "5491100000005" }
  ],
  "0E": [
    { nombre: "Propietario 0E 1", numero: "5491100000010" }
  ],
  "0F": [
    { nombre: "Propietario 0F 1", numero: "5491100000006" }
  ],
  "1D": [
    { nombre: "Contacto 1D", numero: "5491100000008" }
  ],
  "1E": [
    { nombre: "Persona 1E 1", numero: "5491100000013" }
  ],
  "1F": [
    { nombre: "Contacto 1F", numero: "5491100000014" }
  ],
  "2D": [
    { nombre: "Contacto 2D", numero: "5491100000016" }
  ],
  "2E": [
    { nombre: "Contacto 2E", numero: "5491100000017" }
  ],
  "2F": [
    { nombre: "Contacto 2F", numero: "5491100000018" }
  ],
  "3D": [
    { nombre: "Contacto 3D", numero: "5491100000021" }
  ],
  "3E": [
    { nombre: "Lau", numero: "5491161722511" }
  ],
  "3F": [
    { nombre: "Majo", numero: "5491132066779" }
  ],
  "4D": [
    { nombre: "Contacto 4D", numero: "5491100000024" }
  ],
  "4E": [
    { nombre: "Contacto 4E", numero: "5491100000025" }
  ],
  "4F": [
    { nombre: "Contacto 4F 1", numero: "5491100000026" }
  ],
  "5D": [
    { nombre: "Contacto 5D 1", numero: "5491100000028" }
  ],
  "5E": [
    { nombre: "Contacto 5E 1", numero: "5491138262836" },
    { nombre: "Contacto 5E 1", numero: "5491156442637" }
  ],
  "5F": [
    { nombre: "Contacto 5F 1", numero: "5491170087927" }
  ],
  "6D": [
    { nombre: "Contacto 6D 1", numero: "5491100000035" }
  ],
  "6E": [
    { nombre: "Contacto 6E 1", numero: "5491100000036" }
  ],
  "6F": [
    { nombre: "Contacto 6F 1", numero: "5491100000037" }
  ],
  "7D": [
    { nombre: "Luciana", numero: "5491132281904" }
  ],
  "7E": [
    { nombre: "Contacto 7E 1", numero: "5491100000039" }
  ],
  "7F": [
    { nombre: "Contacto 7F 1", numero: "5491100000040" }
  ],
  "8D": [
    { nombre: "Contacto 8D 1", numero: "5491100000041" }
  ],
  "8E": [
    { nombre: "Contacto 8E 1", numero: "5491100000042" }
  ],
  "8F": [
    { nombre: "Contacto 8F 1", numero: "5491100000043" }
  ],
  "9D": [
    { nombre: "Contacto 9D 1", numero: "5491100000044" }
  ],
  "9E": [
    { nombre: "Contacto 9E 1", numero: "5491131617118" },
    { nombre: "Contacto 9E 2", numero: "5491166535883" }
  ],
  "9F": [
    { nombre: "Persona 1", numero: "5491123312815" },
    { nombre: "Persona 2", numero: "5491122771234" }
    
  ]
};

const deptoSelect = document.getElementById("depto");
const personaContainer = document.getElementById("persona-container");
const personaSelect = document.getElementById("persona");
const tipoInput = document.getElementById("tipo");
const mensajeDiv = document.getElementById("mensaje");

// Cargar último depto seleccionado y actualizar lista personas
window.addEventListener("load", () => {
  const ultimoDepto = localStorage.getItem("ultimoDepto");
  if (ultimoDepto && contactos[ultimoDepto]) {
    deptoSelect.value = ultimoDepto;
    actualizarPersonas();
  }
});

deptoSelect.addEventListener("change", actualizarPersonas);

function actualizarPersonas() {
  const depto = deptoSelect.value;
  localStorage.setItem("ultimoDepto", depto);
  const personas = contactos[depto] || [];
  personaSelect.innerHTML = "";

  if (personas.length > 0) {
    personaContainer.style.display = "block"; // Siempre mostrar si hay al menos uno
    personas.forEach(p => {
      const opt = document.createElement("option");
      opt.value = p.numero;
      opt.textContent = p.nombre;
      personaSelect.appendChild(opt);
    });
  } else {
    personaContainer.style.display = "none";
  }
}

function mostrarMensaje(msg, color = "green") {
  mensajeDiv.textContent = msg;
  mensajeDiv.style.color = color;
  setTimeout(() => (mensajeDiv.textContent = ""), 4000);
}

function enviarMensaje() {
  const depto = deptoSelect.value;
  const tipo = tipoInput.value.trim();

  if (!depto || !contactos[depto]) {
    mostrarMensaje("Seleccioná un departamento válido", "red");
    return;
  }
  if (!tipo) {
    mostrarMensaje("Ingresá un tipo válido", "red");
    return;
  }

  const personas = contactos[depto];
  if (!personas || personas.length === 0) {
    mostrarMensaje("No hay contactos para este departamento", "red");
    return;
  }

  const texto = `Hola, soy ${tipo}. Estoy en la entrada del edificio y quiero comunicarme con el Dpto ${depto}.`;
  const encodedMsg = encodeURIComponent(texto);
  const esMovil = /Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
  const baseUrl = esMovil ? "https://api.whatsapp.com/send" : "https://web.whatsapp.com/send";

  personas.forEach(p => {
    const url = `${baseUrl}?phone=${p.numero}&text=${encodedMsg}`;
    window.open(url, "_blank");
  });

  mostrarMensaje(`Mensaje preparado para enviar a ${personas.length} contacto(s).`);
}

function avisarPorteria() {
  const persona = contactos["PB"] && contactos["PB"][0];
  if (!persona) {
    mostrarMensaje("No hay contacto de portería definido", "red");
    return;
  }
  const texto = "Hola, estoy en la entrada del edificio. Necesito comunicarme con la portería.";
  const encodedMsg = encodeURIComponent(texto);
  const esMovil = /Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
  const baseUrl = esMovil ? "https://api.whatsapp.com/send" : "https://web.whatsapp.com/send";
  const url = `${baseUrl}?phone=${persona.numero}&text=${encodedMsg}`;
  window.open(url, "_blank");
  mostrarMensaje("Aviso enviado a portería.");
}

document.getElementById("btnEnviar").addEventListener("click", enviarMensaje);
document.getElementById("btnPorteria").addEventListener("click", avisarPorteria);
</script>
</body>
</html>
